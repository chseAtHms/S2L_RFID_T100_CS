/*******************************************************************************
********************************************************************************
**
** File Name
** ---------
**
** crc-hal.c
**
** $Id: crc-hal.c 2448 2017-03-27 13:45:16Z klan $
** $Revision: 2448 $
** $Date: 2017-03-27 15:45:16 +0200 (Mo, 27 Mrz 2017) $
** $Author: klan $
**
** Original Author: T. Langenbacher
**
********************************************************************************
********************************************************************************
**
** Description
** -----------
**
** This module contains the crc16 and crc8 calculation.
** This module calculates byte-wise a byte to a crc8 or a crc16. The polynomial
** 0x97 is used for the crc8 calculation, for the crc16 the polynomial 0xBAAD.
**
**
********************************************************************************
********************************************************************************
**                                                                            **
** COPYRIGHT NOTIFICATION (c) 2011 HMS Industrial Networks AB                 **
**                                                                            **
** This program is the property of HMS Industrial Networks AB.                **
** It may not be reproduced, distributed, or used without permission          **
** of an authorised company official.                                         **
**                                                                            **
********************************************************************************
********************************************************************************
*/

/*******************************************************************************
**
** includes
**
********************************************************************************
*/
/* Project header */
#include "xtypes.h"
#include "xdefs.h"

/* Module header */
#include "globDef_GlobalDefinitions.h"

/* Header-file of module */
#include "crc-hal.h"

/*******************************************************************************
**
** Public Globals
**
********************************************************************************
*/


/*******************************************************************************
**
** Private Globals
**
********************************************************************************
*/

/*! Lookup-Table for 8-Bit CCITT CRC (polynomial = 0x97). */
STATIC CONST UINT8 crcHAL_au8Crc8Table[] =
{
  0x00u,  0x97u,  0xB9u,  0x2Eu,  0xE5u,  0x72u,  0x5Cu,  0xCBu,
  0x5Du,  0xCAu,  0xE4u,  0x73u,  0xB8u,  0x2Fu,  0x01u,  0x96u,
  0xBAu,  0x2Du,  0x03u,  0x94u,  0x5Fu,  0xC8u,  0xE6u,  0x71u,
  0xE7u,  0x70u,  0x5Eu,  0xC9u,  0x02u,  0x95u,  0xBBu,  0x2Cu,
  0xE3u,  0x74u,  0x5Au,  0xCDu,  0x06u,  0x91u,  0xBFu,  0x28u,
  0xBEu,  0x29u,  0x07u,  0x90u,  0x5Bu,  0xCCu,  0xE2u,  0x75u,
  0x59u,  0xCEu,  0xE0u,  0x77u,  0xBCu,  0x2Bu,  0x05u,  0x92u,
  0x04u,  0x93u,  0xBDu,  0x2Au,  0xE1u,  0x76u,  0x58u,  0xCFu,
  0x51u,  0xC6u,  0xE8u,  0x7Fu,  0xB4u,  0x23u,  0x0Du,  0x9Au,
  0x0Cu,  0x9Bu,  0xB5u,  0x22u,  0xE9u,  0x7Eu,  0x50u,  0xC7u,
  0xEBu,  0x7Cu,  0x52u,  0xC5u,  0x0Eu,  0x99u,  0xB7u,  0x20u,
  0xB6u,  0x21u,  0x0Fu,  0x98u,  0x53u,  0xC4u,  0xEAu,  0x7Du,
  0xB2u,  0x25u,  0x0Bu,  0x9Cu,  0x57u,  0xC0u,  0xEEu,  0x79u,
  0xEFu,  0x78u,  0x56u,  0xC1u,  0x0Au,  0x9Du,  0xB3u,  0x24u,
  0x08u,  0x9Fu,  0xB1u,  0x26u,  0xEDu,  0x7Au,  0x54u,  0xC3u,
  0x55u,  0xC2u,  0xECu,  0x7Bu,  0xB0u,  0x27u,  0x09u,  0x9Eu,
  0xA2u,  0x35u,  0x1Bu,  0x8Cu,  0x47u,  0xD0u,  0xFEu,  0x69u,
  0xFFu,  0x68u,  0x46u,  0xD1u,  0x1Au,  0x8Du,  0xA3u,  0x34u,
  0x18u,  0x8Fu,  0xA1u,  0x36u,  0xFDu,  0x6Au,  0x44u,  0xD3u,
  0x45u,  0xD2u,  0xFCu,  0x6Bu,  0xA0u,  0x37u,  0x19u,  0x8Eu,
  0x41u,  0xD6u,  0xF8u,  0x6Fu,  0xA4u,  0x33u,  0x1Du,  0x8Au,
  0x1Cu,  0x8Bu,  0xA5u,  0x32u,  0xF9u,  0x6Eu,  0x40u,  0xD7u,
  0xFBu,  0x6Cu,  0x42u,  0xD5u,  0x1Eu,  0x89u,  0xA7u,  0x30u,
  0xA6u,  0x31u,  0x1Fu,  0x88u,  0x43u,  0xD4u,  0xFAu,  0x6Du,
  0xF3u,  0x64u,  0x4Au,  0xDDu,  0x16u,  0x81u,  0xAFu,  0x38u,
  0xAEu,  0x39u,  0x17u,  0x80u,  0x4Bu,  0xDCu,  0xF2u,  0x65u,
  0x49u,  0xDEu,  0xF0u,  0x67u,  0xACu,  0x3Bu,  0x15u,  0x82u,
  0x14u,  0x83u,  0xADu,  0x3Au,  0xF1u,  0x66u,  0x48u,  0xDFu,
  0x10u,  0x87u,  0xA9u,  0x3Eu,  0xF5u,  0x62u,  0x4Cu,  0xDBu,
  0x4Du,  0xDAu,  0xF4u,  0x63u,  0xA8u,  0x3Fu,  0x11u,  0x86u,
  0xAAu,  0x3Du,  0x13u,  0x84u,  0x4Fu,  0xD8u,  0xF6u,  0x61u,
  0xF7u,  0x60u,  0x4Eu,  0xD9u,  0x12u,  0x85u,  0xABu,  0x3Cu
};


/*! Lookup-Table for 16-Bit CRC (polynomial = 0xBAAD)*/
STATIC CONST UINT16 crcHAL_au16Crc16Table[] =
{
   0x0000u, 0xBAADu, 0xCFF7u, 0x755Au, 0x2543u, 0x9FEEu, 0xEAB4u, 0x5019u,
   0x4A86u, 0xF02Bu, 0x8571u, 0x3FDCu, 0x6FC5u, 0xD568u, 0xA032u, 0x1A9Fu,
   0x950Cu, 0x2FA1u, 0x5AFBu, 0xE056u, 0xB04Fu, 0x0AE2u, 0x7FB8u, 0xC515u,
   0xDF8Au, 0x6527u, 0x107Du, 0xAAD0u, 0xFAC9u, 0x4064u, 0x353Eu, 0x8F93u,
   0x90B5u, 0x2A18u, 0x5F42u, 0xE5EFu, 0xB5F6u, 0x0F5Bu, 0x7A01u, 0xC0ACu,
   0xDA33u, 0x609Eu, 0x15C4u, 0xAF69u, 0xFF70u, 0x45DDu, 0x3087u, 0x8A2Au,
   0x05B9u, 0xBF14u, 0xCA4Eu, 0x70E3u, 0x20FAu, 0x9A57u, 0xEF0Du, 0x55A0u,
   0x4F3Fu, 0xF592u, 0x80C8u, 0x3A65u, 0x6A7Cu, 0xD0D1u, 0xA58Bu, 0x1F26u,
   0x9BC7u, 0x216Au, 0x5430u, 0xEE9Du, 0xBE84u, 0x0429u, 0x7173u, 0xCBDEu,
   0xD141u, 0x6BECu, 0x1EB6u, 0xA41Bu, 0xF402u, 0x4EAFu, 0x3BF5u, 0x8158u,
   0x0ECBu, 0xB466u, 0xC13Cu, 0x7B91u, 0x2B88u, 0x9125u, 0xE47Fu, 0x5ED2u,
   0x444Du, 0xFEE0u, 0x8BBAu, 0x3117u, 0x610Eu, 0xDBA3u, 0xAEF9u, 0x1454u,
   0x0B72u, 0xB1DFu, 0xC485u, 0x7E28u, 0x2E31u, 0x949Cu, 0xE1C6u, 0x5B6Bu,
   0x41F4u, 0xFB59u, 0x8E03u, 0x34AEu, 0x64B7u, 0xDE1Au, 0xAB40u, 0x11EDu,
   0x9E7Eu, 0x24D3u, 0x5189u, 0xEB24u, 0xBB3Du, 0x0190u, 0x74CAu, 0xCE67u,
   0xD4F8u, 0x6E55u, 0x1B0Fu, 0xA1A2u, 0xF1BBu, 0x4B16u, 0x3E4Cu, 0x84E1u,
   0x8D23u, 0x378Eu, 0x42D4u, 0xF879u, 0xA860u, 0x12CDu, 0x6797u, 0xDD3Au,
   0xC7A5u, 0x7D08u, 0x0852u, 0xB2FFu, 0xE2E6u, 0x584Bu, 0x2D11u, 0x97BCu,
   0x182Fu, 0xA282u, 0xD7D8u, 0x6D75u, 0x3D6Cu, 0x87C1u, 0xF29Bu, 0x4836u,
   0x52A9u, 0xE804u, 0x9D5Eu, 0x27F3u, 0x77EAu, 0xCD47u, 0xB81Du, 0x02B0u,
   0x1D96u, 0xA73Bu, 0xD261u, 0x68CCu, 0x38D5u, 0x8278u, 0xF722u, 0x4D8Fu,
   0x5710u, 0xEDBDu, 0x98E7u, 0x224Au, 0x7253u, 0xC8FEu, 0xBDA4u, 0x0709u,
   0x889Au, 0x3237u, 0x476Du, 0xFDC0u, 0xADD9u, 0x1774u, 0x622Eu, 0xD883u,
   0xC21Cu, 0x78B1u, 0x0DEBu, 0xB746u, 0xE75Fu, 0x5DF2u, 0x28A8u, 0x9205u,
   0x16E4u, 0xAC49u, 0xD913u, 0x63BEu, 0x33A7u, 0x890Au, 0xFC50u, 0x46FDu,
   0x5C62u, 0xE6CFu, 0x9395u, 0x2938u, 0x7921u, 0xC38Cu, 0xB6D6u, 0x0C7Bu,
   0x83E8u, 0x3945u, 0x4C1Fu, 0xF6B2u, 0xA6ABu, 0x1C06u, 0x695Cu, 0xD3F1u,
   0xC96Eu, 0x73C3u, 0x0699u, 0xBC34u, 0xEC2Du, 0x5680u, 0x23DAu, 0x9977u,
   0x8651u, 0x3CFCu, 0x49A6u, 0xF30Bu, 0xA312u, 0x19BFu, 0x6CE5u, 0xD648u,
   0xCCD7u, 0x767Au, 0x0320u, 0xB98Du, 0xE994u, 0x5339u, 0x2663u, 0x9CCEu,
   0x135Du, 0xA9F0u, 0xDCAAu, 0x6607u, 0x361Eu, 0x8CB3u, 0xF9E9u, 0x4344u,
   0x59DBu, 0xE376u, 0x962Cu, 0x2C81u, 0x7C98u, 0xC635u, 0xB36Fu, 0x09C2u
};

/*******************************************************************************
**
** Public Services
**
********************************************************************************
*/

/*------------------------------------------------------------------------------
**
** crcHAL_CalcCRC8
**
** Description:
** This function calculates a byte to a 8bit crc.
** The crc calculation uses a crc look-up table to calculate the crc.
** The polynomial which is used is 0x97.
**------------------------------------------------------------------------------
** Inputs:
**    u8Crc       CRC to add the byte.
**    u8Byte      Byte to add to CRC.
**    UINT8       Calculated CRC.
**
** Return:
**    UINT8       Calculated CRC
**
** Usage:
**    - None -
**
** Module Test:
**    - NO -
**    Reason: low complexity
**------------------------------------------------------------------------------
*/
UINT8 crcHAL_CalcCRC8 (CONST UINT8 u8Crc, CONST UINT8 u8Byte)
{
   return crcHAL_au8Crc8Table[u8Byte ^ u8Crc];
}


/*------------------------------------------------------------------------------
**
** crcHAL_CalcCRC16
**
** Description:
** This function calculates a byte to a 16bit crc.
** The crc calculation uses a crc look-up table to calculate the crc.
** The polynomial which is used is 0xBAAD.
**------------------------------------------------------------------------------
** Inputs:
**    u16Crc      CRC to add the byte.
**    u8Byte      Byte to add to CRC.
**
** Return:
**    UINT16      Calculated CRC.
**
** Usage:
**    - None -
**
** Module Test:
**    - NO -
**    Reason: low complexity
**------------------------------------------------------------------------------
*/
UINT16 crcHAL_CalcCRC16 (CONST UINT16 u16Crc, CONST UINT8 u8Byte)
{
   /* RSM_IGNORE_QUALITY_BEGIN Notice #1 - Physical line length > 100 characters */
   return crcHAL_au16Crc16Table[(u16Crc >> 8u) ^ (UINT16)((UINT16)u8Byte & GLOBDEF_MASK_UINT16_LOW_BYTE)] \
      ^ ((UINT16)(u16Crc << 8u));
   /* RSM_IGNORE_QUALITY_END */
}


/*******************************************************************************
**
** Private Services
**
********************************************************************************
*/


/*******************************************************************************
**
** End of crc-hal.c
**
********************************************************************************
*/
